---
title: "Source Code"
---

## PAMGuard Source Code

PAMGUARD is open source software licensed under the [GNU General Public License V3.0](https://www.gnu.org/licenses/gpl-3.0.en.html) from the Free Software Foundation.

PAMGuard is mostly written in [Java](https://en.wikipedia.org/wiki/Java_(programming_language)) which provides a good balance between speed, flexibility, and ease of development.

Interfaces to external instruments, for example National Instruments data acquisition devices, are often written in C/C++ and accessed from the Java code using the [Java Native Interface](https://en.wikipedia.org/wiki/Java_Native_Interface) or use [Java Native Access](https://en.wikipedia.org/wiki/Java_Native_Access) to communicate with device manufacturers C libraries. These can be built using the Community Edition of [Visual Studio](https://visualstudio.microsoft.com/vs/community/).

All PAMGuard source code is available on [GitHub](https://github.com/PAMGuard).

## Use of Eclipse

Many PAMGuard developers use the Eclipse IDE for code development. This guide shows users how to import PAMGuard into Eclipse and get it running. Other IDE's will follow similar lines.

### Setting PAMGuard up in Eclipse

There are several ways to open the code with Eclipse. The first stage is to import the project. THere are two options for this.

#### Option 1: Using GitHub Desktop

-   **Install**: Ensure the GitHub Desktop application is installed.
-   **Clone**: From the GitHub webpage, click the green **'Code'** button and select **'Open with GitHub desktop'**.
-   **Local Path**: Choose a local path on your computer and press **'Clone'**.
-   **Import**: In Eclipse, select **File \> Import \> Existing Projects into workspace**. Enter the repository path and click **Finish**.

#### Option 2: Using EGit (Direct Import)

1.  Select **File \> Import \> Projects from Git**.
2.  Hit **Next** and select **'Clone URI'**.
3.  Copy your repository URL into the **URI** field; other fields should auto-fill.
4.  **Authentication**: If you have password issues, you may need to create a **Personal Access Token** on GitHub to use in place of a regular password.
5.  **Branch**: Select the **'main'** branch.
6.  **Local Destination**: Select your local storage directory.
7.  **Wizard**: Select the option to **'Import existing Eclipse projects'**.

### Running PAMGuard

To run PAMGuard in Eclipse you need to create a new Java run configuration. Click on the drop down menu of the green run arrow in Eclipse. Select **Run Configuration...** and this will open a new window. Select your PAMGuard project in **Project:** and then type \`\``pamguard.Pamguard`\`\` in the **Main class:** field.

![](images/clipboard-346099819.png)

*The run configuration dialog in Eclipse to set up to run PAMGuard.*

The next stage is to add the Program and VM arguments. The program argument if set to nothing will open PAMGaurd in normal (real-time) mode. A `-v` will open in viewer mode and a `-c` will open a window that gives users a choice of which mode to run. The VM arguments are used to increase the amount of memory available to PAMGuard and to ensure that the correct lib folder is accessed for native libraries. The arguments to add are

::: panel-tabset
### Windows

Windows requires both a maximum memory allocation and a native library to make soundcards etc work. 

```     
-mx8192m
-Djava.library.path=lib64
```

### macOS

macOS has no native libraries (only basic soundcards are supported on macOS) and so does not need a lib folder.

```     
-mx8192m
```

### Linux

There are scaling issues with many Linux distributions and so extra arguments are needed. Linux also has it's own lib folder.

```     
-mx8192m
-Djava.library.path=liblinux
-Dsun.java2d.uiScale=2 
-Dawt.useSystemAAFontSettings=on
-Dswing.aatext=true
```
Note the ```uiScale=2``` is for higher DPI displays. If you have a lower resolution display set this to 1. 

:::


![](images/pamguard_eclipse.png)

*The arguments to add to increase memory and access correct lib folder.*

------------------------------------------------------------------------

## Maven

### Building PAMGuard

PAMGuard is built using Maven. The Maven pom.xml is extensive and includes code to build installers for macOS and Linux as well as packaging dependencies into a jar file, removing files that interfere with deep learning models etc. The Maven commands for building PAMGuard depends on the platform. Building a runnable jar for any platform uses the same Maven goals

```         
mvn clean package shade:shade
```

There are platform dependent commands for building installers

::: panel-tabset
### macOS

Maven builds a signed.dmg file for macOS which can be used on Apple Silicon based devices. The installer is signed but this requires a an Apple Developer account. PAMGuard also needs to be submitted to Apple and further signed before it can be distributed. This is all handled in the pom.xml file which means building can take a long time! 

```         
mvn clean package shade:shade macosappbundler:bundle exec:exec@sign-app
```

### Linux

Maven builds a .deb file for Linux which can be used on Ubuntu and other Debian based systems. The .deb installer will only work if the following maven commands is used. Note that a .deb file will be created during a normal build but will not have the correct jar file with dependencies.

```         
mvn clean package shade:shade org.vafer:jdeb:jdeb
```

There are additonal build instructions for Linux [here](https://github.com/PAMGuard/PAMGuard/blob/main/build/COMPILE.md). 
:::

### Issues

#### JavaFX

There are issues with certain Maven repositories interfering with JavaFX

-   **Locate pom.xml**: Find and edit the `pom.xml` file
-   **The Fix**:
    -   Find the "Repo for Jamie's code" near line 250
    -   Comment out this repository section
    -   Perform a **Maven update**
    -   Uncomment the repository and update Maven again

#### jpam

jpam is a deep learning library that PAMgaurd uses. It is available on Maven Central but, the latest dev version of PAMGuard may use a version of JPam that is not yet on Maven Central. This means that to build PAMGuard you need to first build and install the correct version of JPam. The JPam code is available on GitHub [here](https://github.com/macster110/jpam). 

Clone the project, import the project and all the sub projects into Eclipse. Then run ```-mvn clean install`` to install to your local machine. PAMGuard will then be able to find the correct version of JPam when you build PAMGuard.

## Assistance

Information on the [PAMGuard API](./api/index.html) and on how to make PAMGuard [modules](devmodules.html) and [plug-ins](devplugins.html) is available on this web site.

The PAMGuard team have limited time to spend assisting developers if the development project is in line with the interests of our current sponsors.
